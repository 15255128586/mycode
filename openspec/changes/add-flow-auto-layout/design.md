## Context
流程图页面希望提供自动排布，避免人工拖拽摆放带来的成本。当前节点定义已包含顺序与分支语义，需要一个能处理有向无环图的布局方式。

## Goals / Non-Goals
- Goals: 自动计算节点位置；支持重新排布；保持现有视觉风格与连线样式。
- Non-Goals: 不实现复杂的交互式编辑器或拖拽吸附规则。

## Decisions
- Decision: 使用 `dagre` 计算自上而下的有向图布局（TB），输出节点坐标后再渲染。
- Alternatives considered: 手写简易分层算法（维护成本更高且对分支对齐较弱）。
- Decision: 节点位置按固定网格对齐，拖拽结束后吸附到最近格位。

## Risks / Trade-offs
- 布局在极大节点量时可能有性能压力 → 使用一次性计算，避免每次渲染重排。
- 自动排布可能覆盖用户手动调整 → 仅在初次渲染与显式触发时执行。
- 网格吸附可能限制精细摆放 → 提供统一的格位尺寸，保证视觉秩序。

## Migration Plan
- 添加依赖并在流程图页面引入布局逻辑。
- 保持现有节点数据结构不变，仅在渲染前计算位置。

## Open Questions
- 需要提供按钮还是双击画布触发重排？
- 网格尺寸与列数是否需要后续可配置？
